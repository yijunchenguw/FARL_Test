% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FARLR_EM.R
\name{farlr_em}
\alias{farlr_em}
\title{FARLR Approach II via EM}
\usage{
farlr_em(
  n,
  resp,
  parTab,
  K_hat,
  p,
  lambda_all,
  delta.criteria = 0.001,
  iter.max = 500,
  n_sam = 50,
  window.size = 50,
  theta_est_irt.mean,
  theta_est_irt.se,
  resp_rep,
  Z.em,
  main,
  verbose = TRUE
)
}
\arguments{
\item{n}{Integer. Sample size.}

\item{resp}{Matrix. Item response matrix (individuals \eqn{\times} items).}

\item{K_hat}{Integer. Estimated number of latent dimensions.}

\item{p}{Integer. Number of covariates.}

\item{lambda_all}{Numeric vector or matrix. Regularization parameters.}

\item{delta.criteria}{Numeric. Convergence threshold for parameter updates.
Default is \code{1e-3}.}

\item{iter.max}{Integer. Maximum number of EM iterations.
Default is \code{500}.}

\item{n_sam}{Integer. Number of Monte Carlo or posterior samples.
Default is \code{50}.}

\item{window.size}{Integer. Window size used for convergence diagnostics.
Default is \code{50}.}

\item{theta_est_irt.mean}{Numeric matrix. Initial latent ability means
obtained from an IRT model.}

\item{theta_est_irt.se}{Numeric matrix. Standard errors of IRT-based latent
ability estimates.}

\item{resp_rep}{Matrix. Replicated or augmented response matrix used in EM.}

\item{Z.em}{Matrix. Design matrix for EM-based latent regression.}

\item{main}{Logical. If \code{TRUE}, uses main effects only in the regression.}

\item{a}{Numeric vector or matrix. Item discrimination parameters.}

\item{d}{Numeric vector or matrix. Item difficulty (or intercept) parameters.}

\item{c}{Numeric vector. Guessing parameters (if applicable).}
}
\value{
A list containing:
\itemize{
  \item \code{coef}: Estimated coefficients from the latent regression model.
  \item \code{sigma}: Estimated covariance matrix of the latent variables.
  \item \code{minBIC}: Minimum Bayesian Information Criterion (BIC) value achieved during model fitting.
  \item \code{converged}: Logical indicator of whether the EM algorithm converged.
  \item \code{cov}: Number of EM iterations required until convergence.
}
}
\description{
Implements FARLR Approach II using an EM algorithm. The method estimates latent
regression parameters from covariates with structured
covariance and supports iterative updating with convergence control.
}
\details{
FARLR Approach II models covariate-dependent heteroskedasticity through
a low-rank random-effects formulation of the latent covariance structure.
Estimation is carried out via a Gaussian Variational EM algorithm, where
closed-form updates are available for latent regression and covariance
parameters, while convergence is monitored using a sliding window criterion.
}
